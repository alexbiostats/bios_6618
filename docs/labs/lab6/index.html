<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alex Kaizer">

<title>Alex Kaizer - Week 6 Lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/academicons-1.9.2/size.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/academicons-1.9.1/css/academicons.css" rel="stylesheet">

<link rel="icon" type="image/png" href="./files/favicon.ico">

<script type="text/javascript">
function setBrand() {
document.getElementsByClassName("navbar-brand")[0].href="https://www.alexkaizer.com";
}
window.onload = setBrand;
</script>
<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5PBG7BL207"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5PBG7BL207');
</script>

<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Alex Kaizer</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://www.alexkaizer.com/research" rel="" target="">
 <span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.alexkaizer.com/publications" rel="" target="">
 <span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-teaching" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Teaching</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-teaching">    
        <li>
    <a class="dropdown-item" href="https://www.alexkaizer.com/teaching" rel="" target="">
 <span class="dropdown-text">Overview</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.alexkaizer.com/bios_6618" rel="" target="">
 <span class="dropdown-text">BIOS 6618</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.alexkaizer.com/bios_6611" rel="" target="">
 <span class="dropdown-text">BIOS 6611</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.alexkaizer.com/study_design_berd" rel="" target="">
 <span class="dropdown-text">BERD Study Design Short Course</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://www.alexkaizer.com/adaptivetrials_sc" rel="" target="">
 <span class="dropdown-text">WNAR Adaptive and Bayesian Clinical Trial Design Short Course</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bios-6618" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">BIOS 6618</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bios-6618">    
        <li>
    <a class="dropdown-item" href="../../index.html" rel="" target="">
 <span class="dropdown-text">Home</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../bios_6618_materials" rel="" target="">
 <span class="dropdown-text">Materials</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../journal_of_bios_6618" rel="" target="">
 <span class="dropdown-text">Journal of BIOS 6618</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../recitation" rel="" target="">
 <span class="dropdown-text">Recitation Questions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../labs" rel="" target="">
 <span class="dropdown-text">Labs and Practice Problems</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="mailto:alex.kaizer@cuanschutz.edu" rel="" target=""><i class="bi bi-envelope" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://scholar.google.com/citations?user=ICpH74EAAAAJ&amp;hl=en" rel="" target="">
 <span class="menu-text"><i class="ai  ai-google-scholar ai-large"></i></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="http://github.com/alexbiostats" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.alexkaizer.com/files/Alex_CV.pdf" rel="" target="">
 <span class="menu-text"><i class="ai  ai-cv ai-large"></i></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/alex-kaizer/" rel="" target=""><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#whats-on-the-docket-this-week" id="toc-whats-on-the-docket-this-week" class="nav-link active" data-scroll-target="#whats-on-the-docket-this-week">What’s on the docket this week?</a></li>
  <li><a href="#a-colorful-illustration-of-bootstraps-and-permutations" id="toc-a-colorful-illustration-of-bootstraps-and-permutations" class="nav-link" data-scroll-target="#a-colorful-illustration-of-bootstraps-and-permutations">A Colorful Illustration of Bootstraps and Permutations</a>
  <ul class="collapse">
  <li><a href="#the-colorful-dataset" id="toc-the-colorful-dataset" class="nav-link" data-scroll-target="#the-colorful-dataset">The Colorful Dataset</a></li>
  </ul></li>
  <li><a href="#bootstrap-and-permutation-test-example-the-ratio-of-sample-variances" id="toc-bootstrap-and-permutation-test-example-the-ratio-of-sample-variances" class="nav-link" data-scroll-target="#bootstrap-and-permutation-test-example-the-ratio-of-sample-variances">Bootstrap and Permutation Test Example: The Ratio of Sample Variances</a>
  <ul class="collapse">
  <li><a href="#null-scenario" id="toc-null-scenario" class="nav-link" data-scroll-target="#null-scenario">Null Scenario</a></li>
  <li><a href="#null-scenario-bootstrap" id="toc-null-scenario-bootstrap" class="nav-link" data-scroll-target="#null-scenario-bootstrap"><strong>Null Scenario: Bootstrap</strong></a></li>
  <li><a href="#null-scenario-permutation-test" id="toc-null-scenario-permutation-test" class="nav-link" data-scroll-target="#null-scenario-permutation-test"><strong>Null Scenario: Permutation Test</strong></a></li>
  <li><a href="#alternative-scenario" id="toc-alternative-scenario" class="nav-link" data-scroll-target="#alternative-scenario">Alternative Scenario</a></li>
  <li><a href="#alternative-scenario-bootstrap" id="toc-alternative-scenario-bootstrap" class="nav-link" data-scroll-target="#alternative-scenario-bootstrap"><strong>Alternative Scenario: Bootstrap</strong></a></li>
  <li><a href="#alternative-scenario-permutation-test" id="toc-alternative-scenario-permutation-test" class="nav-link" data-scroll-target="#alternative-scenario-permutation-test"><strong>Alternative Scenario: Permutation Test</strong></a></li>
  <li><a href="#wait-a-minute-what-is-the-distribution-of-the-ratio-of-variances" id="toc-wait-a-minute-what-is-the-distribution-of-the-ratio-of-variances" class="nav-link" data-scroll-target="#wait-a-minute-what-is-the-distribution-of-the-ratio-of-variances">Wait a Minute, What is the Distribution of the Ratio of Variances??</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Week 6 Lab</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Alex Kaizer </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Colorado-Anschutz Medical Campus
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
  
    
  </div>
  

</header>

<p>This page is part of the University of Colorado-Anschutz Medical Campus’ <a href="../../labs/index.html">BIOS 6618 Labs</a> collection, the mini-lecture content delivered at the start of class before breaking out into small groups to work on the homework assignment.</p>
<section id="whats-on-the-docket-this-week" class="level1">
<h1>What’s on the docket this week?</h1>
<p>In Week 6 we are focusing on additional examples of bootstraps and permutation tests. Another helpful visual explainer of permutation tests is <a href="https://www.jwilber.me/permutationtest/">about being an alpaca shepherd</a>.</p>
</section>
<section id="a-colorful-illustration-of-bootstraps-and-permutations" class="level1">
<h1>A Colorful Illustration of Bootstraps and Permutations</h1>
<p>There are a lot of similarities in between bootstraps and permutations:</p>
<ul>
<li>both involve resampling (with replacement for bootstraps, without replacement for permutations)</li>
<li>both provide a means for evaluating the potential significance of a statistic (interpreting the confidence interval for bootstraps, interpreting a p-value for permutations)</li>
<li>both can be thought of as nonparametric approaches (i.e., we don’t have to assume any underlying distribution to conduct a test)</li>
</ul>
<p>However, the nuances of sampling and what our ultimate goal for conducting either approach make them inherently different methods. If we strongly desire a p-value, we would implement a permutation test. Likewise, if we really wanted an estimate of the variability around a given statistic (e.g., its standard error or confidence interval), we would implement a bootstrap.</p>
<p>These concepts can be challenging to “picture” when considering data cases. As a change of pace, let’s consider the “average” color of a given sample.</p>
<section id="the-colorful-dataset" class="level2">
<h2 class="anchored" data-anchor-id="the-colorful-dataset">The Colorful Dataset</h2>
<p>Let’s assume we have conducted a study with 6 observations in two groups, each represented by a color. Our “outcome” is the average color within the group (we can calculate this using the <code>average_colors()</code> function from the <code>miscHelpers</code> package that can be downloaded from GitHub):</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this function to install the kableExtra package to create some tables</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("haozhu233/kableExtra")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this function to install the miscHelpers package to use the average_colors() function</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("BenaroyaResearch/miscHelpers")</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(miscHelpers)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create vectors to store colors in</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>grp1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#0072B2'</span>,<span class="st">'#0072B2'</span>,<span class="st">'#0072B2'</span>,<span class="st">'#97C9E4'</span>,<span class="st">'#97C9E4'</span>,<span class="st">'#97C9E4'</span>) <span class="co"># vector with 2 blues</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>grp2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#F0E442'</span>,<span class="st">'#F0E442'</span>,<span class="st">'#F0E442'</span>,<span class="st">'#EA1F2F'</span>,<span class="st">'#EA1F2F'</span>,<span class="st">'#EA1F2F'</span>) <span class="co"># vector with reds and yellows</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create matrix for 1:6 (group 1) and A:F (group 2)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>grp_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="st">'Avg. 1'</span>,<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'D'</span>,<span class="st">'E'</span>,<span class="st">'F'</span>,<span class="st">'Avg. 2'</span>), <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">byrow=</span>F, <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">'Observation '</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>),<span class="st">'Average'</span>), <span class="fu">c</span>(<span class="st">'Group 1'</span>,<span class="st">'Group 2'</span>)))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>grp_mat <span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align=</span><span class="st">'cc'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1, <span class="fu">average_colors</span>(grp1))) <span class="sc">%&gt;%</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2, <span class="fu">average_colors</span>(grp2))) <span class="sc">%&gt;%</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">6</span>, <span class="at">extra_css =</span> <span class="st">"border-bottom: 2px solid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Group 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Group 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observation 1</td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">1</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">A</td>
</tr>
<tr class="even">
<td style="text-align: left;">Observation 2</td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">2</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">B</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Observation 3</td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">3</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">C</td>
</tr>
<tr class="even">
<td style="text-align: left;">Observation 4</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">4</td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important;">D</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Observation 5</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">5</td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important;">E</td>
</tr>
<tr class="even">
<td style="text-align: left; border-bottom: 2px solid;">Observation 6</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important; border-bottom: 2px solid;">6</td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important; border-bottom: 2px solid;">F</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Average</td>
<td style="text-align: center; color: black !important; background-color: rgba(75, 157, 203, 255) !important;">Avg. 1</td>
<td style="text-align: center; color: black !important; background-color: rgba(237, 129, 56, 255) !important;">Avg. 2</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>We can see in the above that the average color in Group 1 is a blue that is the “average” of the 3 light and 3 dark blues. For Group 2 the average of 3 yellows and 3 reds is orange.</p>
<p>Let’s first see an example of bootstrap resampling. Remember, here we sample <em>within</em> each group and <em>with replacement</em>:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">515</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>grp1b <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">replace=</span>T))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>grp2b <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">replace=</span>T))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>grp_matb <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">c</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)[grp1b],<span class="st">'Avg. Boot 1'</span>,<span class="fu">c</span>(<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'D'</span>,<span class="st">'E'</span>,<span class="st">'F'</span>)[grp2b],<span class="st">'Avg. Boot 2'</span>), <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">byrow=</span>F)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(grp_matb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Boot Group 1'</span>,<span class="st">'Boot Group 2'</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>grp_combo <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grp_mat, <span class="st">''</span>, grp_matb)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>grp_combo <span class="sc">%&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align=</span><span class="st">'cc'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1, <span class="fu">average_colors</span>(grp1))) <span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2, <span class="fu">average_colors</span>(grp2))) <span class="sc">%&gt;%</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1[grp1b], <span class="fu">average_colors</span>(grp1[grp1b]))) <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">6</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2[grp2b], <span class="fu">average_colors</span>(grp2[grp2b]))) <span class="sc">%&gt;%</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">6</span>, <span class="at">extra_css =</span> <span class="st">"border-bottom: 2px solid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Group 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Group 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Boot Group 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Boot Group 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observation 1</td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">1</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">A</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">1</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">A</td>
</tr>
<tr class="even">
<td style="text-align: left;">Observation 2</td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">2</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">B</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">2</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">A</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Observation 3</td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">3</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">C</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">3</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">B</td>
</tr>
<tr class="even">
<td style="text-align: left;">Observation 4</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">4</td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important;">D</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">4</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">B</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Observation 5</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">5</td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important;">E</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">4</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">C</td>
</tr>
<tr class="even">
<td style="text-align: left; border-bottom: 2px solid;">Observation 6</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important; border-bottom: 2px solid;">6</td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important; border-bottom: 2px solid;">F</td>
<td style="text-align: center; border-bottom: 2px solid;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important; border-bottom: 2px solid;">6</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important; border-bottom: 2px solid;">C</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Average</td>
<td style="text-align: center; color: black !important; background-color: rgba(75, 157, 203, 255) !important;">Avg. 1</td>
<td style="text-align: center; color: black !important; background-color: rgba(237, 129, 56, 255) !important;">Avg. 2</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(75, 157, 203, 255) !important;">Avg. Boot 1</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">Avg. Boot 2</td>
</tr>
</tbody>
</table>


</div>
</div>
<ul>
<li><p>In this bootstrap, we see that Boot Group 1 has resampled the 4th observation twice, so the 5th “light blue” observation is not included in the sample. However, since both observation 4 and 5 are “light blue” the overall average color is unchanged!</p></li>
<li><p>In this bootstrap, we see that Boot Group 2 has resampled each “A”, “B”, and “C” twice…leaving no red observations! In this case the bootstrap distribution is only yellow observations (one potential extreme) and our average is simply yellow.</p></li>
</ul>
<p><strong>How does this differ from a permutation test?</strong> For the permutation test we combine all 12 observations before resampling <em>without replacement</em> as to who belongs to which group:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1012</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>grp_perm <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">replace=</span>F)) <span class="co"># sample 6 observations to go into group 1, the rest will go into group 2</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>grp1p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'D'</span>,<span class="st">'E'</span>,<span class="st">'F'</span>)[grp_perm] <span class="co"># take values according to index sampled for grp_perm</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>grp2p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'D'</span>,<span class="st">'E'</span>,<span class="st">'F'</span>)[<span class="sc">-</span>grp_perm] <span class="co"># remove values according to index sampled from grp_perm</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>grp1p_col <span class="ot">&lt;-</span> <span class="fu">c</span>(grp1,grp2)[grp_perm]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>grp2p_col <span class="ot">&lt;-</span> <span class="fu">c</span>(grp1,grp2)[<span class="sc">-</span>grp_perm]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>grp_matp <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">c</span>(grp1p,<span class="st">'Avg. Perm 1'</span>,grp2p,<span class="st">'Avg. Perm 2'</span>), <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">byrow=</span>F)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(grp_matp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Perm Group 1'</span>,<span class="st">'Perm Group 2'</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>grp_combo2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grp_combo, <span class="st">''</span>, grp_matp)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>grp_combo2 <span class="sc">%&gt;%</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align=</span><span class="st">'cc'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1, <span class="fu">average_colors</span>(grp1))) <span class="sc">%&gt;%</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2, <span class="fu">average_colors</span>(grp2))) <span class="sc">%&gt;%</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1[grp1b], <span class="fu">average_colors</span>(grp1[grp1b]))) <span class="sc">%&gt;%</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">6</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2[grp2b], <span class="fu">average_colors</span>(grp2[grp2b]))) <span class="sc">%&gt;%</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">8</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1p_col, <span class="fu">average_colors</span>(grp1p_col))) <span class="sc">%&gt;%</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">9</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2p_col, <span class="fu">average_colors</span>(grp2p_col))) <span class="sc">%&gt;%</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">6</span>, <span class="at">extra_css =</span> <span class="st">"border-bottom: 2px solid"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Group 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Group 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Boot Group 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Boot Group 2</th>
<th style="text-align: center;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Perm Group 1</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">Perm Group 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observation 1</td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">1</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">A</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">1</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">A</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">1</td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Observation 2</td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">2</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">B</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">2</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">A</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">3</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Observation 3</td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">3</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">C</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(0, 114, 178, 255) !important;">3</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">B</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">A</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Observation 4</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">4</td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important;">D</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">4</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">B</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">C</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Observation 5</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">5</td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important;">E</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important;">4</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">C</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important;">E</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">B</td>
</tr>
<tr class="even">
<td style="text-align: left; border-bottom: 2px solid;">Observation 6</td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important; border-bottom: 2px solid;">6</td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important; border-bottom: 2px solid;">F</td>
<td style="text-align: center; border-bottom: 2px solid;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(151, 201, 228, 255) !important; border-bottom: 2px solid;">6</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important; border-bottom: 2px solid;">C</td>
<td style="text-align: center; border-bottom: 2px solid;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important; border-bottom: 2px solid;">F</td>
<td style="text-align: center; color: black !important; background-color: rgba(234, 31, 47, 255) !important; border-bottom: 2px solid;">D</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Average</td>
<td style="text-align: center; color: black !important; background-color: rgba(75, 157, 203, 255) !important;">Avg. 1</td>
<td style="text-align: center; color: black !important; background-color: rgba(237, 129, 56, 255) !important;">Avg. 2</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(75, 157, 203, 255) !important;">Avg. Boot 1</td>
<td style="text-align: center; color: black !important; background-color: rgba(240, 228, 66, 255) !important;">Avg. Boot 2</td>
<td style="text-align: center;"></td>
<td style="text-align: center; color: black !important; background-color: rgba(158, 124, 97, 255) !important;">Avg. Perm 1</td>
<td style="text-align: center; color: black !important; background-color: rgba(154, 162, 162, 255) !important;">Avg. Perm 2</td>
</tr>
</tbody>
</table>


</div>
</div>
<ul>
<li><p>In our permutation sample we see that group membership has been broken, so that members of the original Group 1 and Group 2 are now part of the Perm Group 1 and Perm Group 2. This process helps us to break any potential association that may have existed previously (e.g., only blues in one group versus red and yellows in another).</p></li>
<li><p>We see our average colors are now an interesting brownish (Avg. Perm 1) and grayish-blue (Avg. Perm 2).</p></li>
<li><p>If our original observation (e.g., the difference in sample means between groups) was actually from the <em>null distribution</em>, then we would expect that estimate to fall near the center of our permutation distribution. In our color example, the original colors are decided in our two camps (blue vs.&nbsp;red/yellow), so here we see a muddier picture of the average color.</p></li>
</ul>
<p>Based on either approach, we would want to conduct a large number of bootstrap or permutation resamples, and then examine the overall distribution:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>bp_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="st">''</span>, <span class="at">ncol=</span><span class="dv">5</span>,<span class="at">nrow=</span><span class="dv">100</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bp_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Boot Group 1'</span>,<span class="st">'Boot Group 2'</span>,<span class="st">''</span>,<span class="st">'Perm Group 1'</span>,<span class="st">'Perm Group 2'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(bp_mat) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'Simulation '</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2020</span><span class="sc">+</span>j)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># permutation resample</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  grp_perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">replace=</span>F) <span class="co"># sample 6 observations to go into group 1, the rest will go into group 2</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  bp_mat[j,<span class="st">'Perm Group 1'</span>] <span class="ot">&lt;-</span> <span class="fu">average_colors</span>(<span class="fu">c</span>(grp1,grp2)[grp_perm])</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  bp_mat[j,<span class="st">'Perm Group 2'</span>] <span class="ot">&lt;-</span> <span class="fu">average_colors</span>(<span class="fu">c</span>(grp1,grp2)[<span class="sc">-</span>grp_perm])</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bootstrap resample</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  bp_mat[j,<span class="st">'Boot Group 1'</span>] <span class="ot">&lt;-</span> <span class="fu">average_colors</span>( grp1[ <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">size=</span><span class="dv">6</span>,<span class="at">replace=</span>T) ])</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  bp_mat[j,<span class="st">'Boot Group 2'</span>] <span class="ot">&lt;-</span> <span class="fu">average_colors</span>( grp2[ <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">size=</span><span class="dv">6</span>,<span class="at">replace=</span>T) ])</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Object to create kable from</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>bp_mat_kableshell <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="st">''</span>, <span class="at">ncol=</span><span class="dv">5</span>,<span class="at">nrow=</span><span class="dv">100</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bp_mat_kableshell) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Boot Group 1'</span>,<span class="st">'Boot Group 2'</span>,<span class="st">''</span>,<span class="st">'Perm Group 1'</span>,<span class="st">'Perm Group 2'</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(bp_mat_kableshell) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'Simulation '</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>bp_mat_kableshell <span class="sc">%&gt;%</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> bp_mat[,<span class="st">'Boot Group 1'</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> bp_mat[,<span class="st">'Boot Group 2'</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> bp_mat[,<span class="st">'Perm Group 1'</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">6</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> bp_mat[,<span class="st">'Perm Group 2'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="lightable-paper table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Boot Group 1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Boot Group 2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Perm Group 1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Perm Group 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Simulation 1</td>
<td style="text-align: left; color: black !important; background-color: rgba(125, 186, 219, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(208, 153, 113, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(104, 133, 145, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 2</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 3</td>
<td style="text-align: left; color: black !important; background-color: rgba(25, 128, 186, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(130, 181, 157, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(182, 106, 102, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 4</td>
<td style="text-align: left; color: black !important; background-color: rgba(125, 186, 219, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 5</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 6</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(155, 195, 165, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(157, 91, 93, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 7</td>
<td style="text-align: left; color: black !important; background-color: rgba(125, 186, 219, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 8</td>
<td style="text-align: left; color: black !important; background-color: rgba(0, 114, 178, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(235, 63, 50, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(104, 133, 145, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(208, 153, 113, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 9</td>
<td style="text-align: left; color: black !important; background-color: rgba(25, 128, 186, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 10</td>
<td style="text-align: left; color: black !important; background-color: rgba(0, 114, 178, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(184, 171, 108, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(128, 115, 151, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 11</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(208, 153, 113, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(104, 133, 145, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 12</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(153, 129, 159, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(159, 157, 100, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 13</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 14</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 15</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(235, 63, 50, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(159, 157, 100, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(153, 129, 159, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 16</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(114, 143, 181, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(198, 143, 78, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 17</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 18</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 19</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 20</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(208, 153, 113, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(104, 133, 145, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 21</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 22</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 23</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(104, 133, 145, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(208, 153, 113, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 24</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 25</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(235, 63, 50, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(158, 124, 97, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(154, 162, 162, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 26</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(240, 228, 66, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(104, 133, 145, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(208, 153, 113, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 27</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(119, 138, 118, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(193, 148, 140, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 28</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(159, 157, 100, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(153, 129, 159, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 29</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(114, 143, 181, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(198, 143, 78, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 30</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(115, 176, 184, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(197, 110, 75, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 31</td>
<td style="text-align: left; color: black !important; background-color: rgba(25, 128, 186, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(157, 91, 93, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(155, 195, 165, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 32</td>
<td style="text-align: left; color: black !important; background-color: rgba(25, 128, 186, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(182, 106, 102, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(130, 181, 157, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 33</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 34</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 35</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(114, 143, 181, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(198, 143, 78, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 36</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 37</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(235, 63, 50, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(142, 87, 120, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(170, 200, 138, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 38</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(155, 195, 165, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(157, 91, 93, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 39</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 40</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 41</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 42</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(115, 176, 184, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(197, 110, 75, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 43</td>
<td style="text-align: left; color: black !important; background-color: rgba(25, 128, 186, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(182, 106, 102, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(130, 181, 157, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 44</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(235, 63, 50, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(194, 181, 143, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(118, 105, 115, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 45</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(130, 181, 157, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(182, 106, 102, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 46</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 47</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 48</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(130, 181, 157, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(182, 106, 102, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 49</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 50</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(240, 228, 66, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 51</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(159, 157, 100, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(153, 129, 159, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 52</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 53</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 54</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(197, 110, 75, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(115, 176, 184, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 55</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(119, 138, 118, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(193, 148, 140, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 56</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(154, 162, 162, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(158, 124, 97, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 57</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(145, 185, 130, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(167, 101, 129, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 58</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 59</td>
<td style="text-align: left; color: black !important; background-color: rgba(125, 186, 219, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(208, 153, 113, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(104, 133, 145, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 60</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 61</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 62</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 63</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 64</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(154, 162, 162, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(158, 124, 97, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 65</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(235, 63, 50, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 66</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 67</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 68</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(89, 129, 172, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(223, 157, 86, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 69</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 70</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(154, 162, 162, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(158, 124, 97, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 71</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(207, 120, 110, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(105, 166, 149, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 72</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(154, 162, 162, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(158, 124, 97, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 73</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(198, 143, 78, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(114, 143, 181, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 74</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(182, 106, 102, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(130, 181, 157, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 75</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(182, 106, 102, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(130, 181, 157, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 76</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 77</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 78</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 79</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(104, 133, 145, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(208, 153, 113, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 80</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(182, 106, 102, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(130, 181, 157, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 81</td>
<td style="text-align: left; color: black !important; background-color: rgba(0, 114, 178, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(198, 143, 78, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(114, 143, 181, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 82</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(167, 101, 129, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(145, 185, 130, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 83</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(223, 157, 86, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(89, 129, 172, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 84</td>
<td style="text-align: left; color: black !important; background-color: rgba(125, 186, 219, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(235, 63, 50, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(198, 143, 78, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(114, 143, 181, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 85</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 86</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(144, 152, 127, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(168, 134, 132, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 87</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 88</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(154, 162, 162, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(158, 124, 97, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 89</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(239, 195, 62, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(114, 143, 181, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(198, 143, 78, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 90</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(234, 31, 47, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(198, 143, 78, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(114, 143, 181, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 91</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 92</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(193, 148, 140, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(119, 138, 118, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 93</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 94</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(235, 63, 50, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(183, 138, 105, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(129, 148, 154, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 95</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(237, 129, 56, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(155, 195, 165, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(157, 91, 93, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 96</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(238, 162, 59, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 97</td>
<td style="text-align: left; color: black !important; background-color: rgba(50, 143, 194, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(118, 105, 115, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(194, 181, 143, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 98</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(208, 153, 113, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(104, 133, 145, 255) !important;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Simulation 99</td>
<td style="text-align: left; color: black !important; background-color: rgba(75, 157, 203, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Simulation 100</td>
<td style="text-align: left; color: black !important; background-color: rgba(100, 172, 211, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(236, 96, 53, 255) !important;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(143, 119, 124, 255) !important;"></td>
<td style="text-align: left; color: black !important; background-color: rgba(169, 167, 135, 255) !important;"></td>
</tr>
</tbody>
</table>


</div>
</div>
<p>If this were an actual study with a numeric outcome we could describe the variability of our average color within or between groups (<strong>bootstrap sampling</strong>) or we could calculate if our observed data is more extreme than the null/permutation distribution (<strong>permutation test</strong>).</p>
<p>Indeed we can see that for all 100 bootstrap samples, there are various shades of blue for Group 1 and red/orange/yellow for Group 2. Whereas for all 100 permutation samples there is a range of colors from purpleish to blueish to orangeish to greenish…a random combination of our colors!</p>
</section>
</section>
<section id="bootstrap-and-permutation-test-example-the-ratio-of-sample-variances" class="level1">
<h1>Bootstrap and Permutation Test Example: The Ratio of Sample Variances</h1>
<p>Assume we have conducted a randomized trial that enrolled 100 total participants with celiac disease to examine the potential effect of a new vaccine (<span class="math inline">\(T\)</span>) to desensitize the immune system in its reaction to gluten as compared to a placebo (<span class="math inline">\(P\)</span>). The outcome is the measure of the tissue transglutaminase IgA antibody (tTG-IgA).</p>
<p>As a secondary analysis of the primary trial, we wish to explore if the variability of tTG-IgA in the two groups with 50 participants each are approximately equal, even if their mean tTG-IgA concentrations are different. To evaluate this, we propose using the ratio of the placebo to the treatment group: [ ] If the ratio is equal to 1, our estimates are the same (i.e., our null hypothesis). Let’s assume that we have zero idea what distribution this may take, so we want to explore using bootstraps to describe the variability or a permutation test to calculate a p-value summary if our sample is unexpected.</p>
<section id="null-scenario" class="level2">
<h2 class="anchored" data-anchor-id="null-scenario">Null Scenario</h2>
<p>Let’s start with the null scenario, where both groups have the same variance. We will simulate from: [ Y_{P} (=10, =3), ; Y_{T} (=5, =) ] These parameters were chosen so that both sets of data will have a variance of 90 (i.e., the variance for the gamma distribution when parameterized with the shape (<span class="math inline">\(k\)</span>) and scale (<span class="math inline">\(\theta\)</span>) is <span class="math inline">\(k\theta^2\)</span>).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">612</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>placebo <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">scale=</span><span class="dv">3</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>vaccine <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">5</span>, <span class="at">scale=</span><span class="fu">sqrt</span>(<span class="dv">18</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(placebo) <span class="co"># calculate the sample variances</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101.8625</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vaccine) <span class="co"># calculate the sample variances</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 93.42304</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>obs_ratio <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo)<span class="sc">/</span><span class="fu">var</span>(vaccine) <span class="co"># calculate the ratio of the variances</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>obs_ratio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.090336</code></pre>
</div>
</div>
</section>
<section id="null-scenario-bootstrap" class="level2">
<h2 class="anchored" data-anchor-id="null-scenario-bootstrap"><strong>Null Scenario: Bootstrap</strong></h2>
<p>Let’s conduct a bootstrap with 10,000 resamples of our ratio of the sample variances to describe the variability of this statistic:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="co">#set number of bootstraps</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>var_ratio <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B) <span class="co">#initialize vector to store results in</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>nP <span class="ot">&lt;-</span> <span class="fu">length</span>(placebo) <span class="co">#sample size of placebo group</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>nT <span class="ot">&lt;-</span> <span class="fu">length</span>(vaccine) <span class="co">#sample size of vaccine group</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">612</span>) <span class="co">#set seed for reproducibility</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    placebo.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(placebo, nP, <span class="at">replace=</span>T)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    vaccine.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(vaccine, nT, <span class="at">replace=</span>T)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    var_ratio[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo.boot) <span class="sc">/</span> <span class="fu">var</span>(vaccine.boot)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s now visualize the shape of our bootstrap distribution:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co">#create plotting area for 2 figures in one row</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(var_ratio, <span class="at">main=</span><span class="st">'Bootstrap Dist. of</span><span class="sc">\n</span><span class="st">Var(Placebo)/Var(Vaccine)'</span>, <span class="at">xlab=</span><span class="st">'Placebo/Vaccine Variance Ratio'</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(var_ratio); <span class="fu">qqline</span>(var_ratio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The shapes of these plots suggest the ratio of variances is not normally distributed. Our histogram is right skewed and the normal Q-Q plot deviates from the diagonal line.</p>
<p>Let’s then calculate the mean, SE, and bias of the bootstrap distribution:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(var_ratio) <span class="co"># bootstrap mean ratio</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.185681</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(var_ratio)<span class="sc">-</span>obs_ratio <span class="co"># bias for ratio</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09534477</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(var_ratio) <span class="co"># bootstrap SE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4441747</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(var_ratio)<span class="sc">-</span>obs_ratio) <span class="sc">/</span> <span class="fu">sd</span>(var_ratio) <span class="co"># estimate of accuracy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.214656</code></pre>
</div>
</div>
<p>The most concerning aspect of this is the bias/SE estimate &gt; 0.10, suggesting our bootstrap percentile intervals may not be very accurate. However, let’s calculate the 95% bootstrap percentile interval as our “best” approach given the two options from our lecture (i.e., normal percentile or bootstrap percentile):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>( var_ratio, <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
0.5456348 2.2689698 </code></pre>
</div>
</div>
<p>For the 95% bootstrap percentile CI, we are 95% confident that the true ratio of variances falls between 0.546 and 2.269. Additionally, because it is estimated from our data directly, 95% of the bootstrap estimates of ratios of variances fall in this interval.</p>
<p>The accuracy of our bootstrap percentile can be estimated by the ratio of the bias/SE, which we noted was 0.215. Since this exceeds +0.10 we may be concerned about the accuracy of this estimate.</p>
<p>It could also be noted that our 95% bootstrap percentile CI includes 1, so we would fail to reject the null hypothesis.</p>
</section>
<section id="null-scenario-permutation-test" class="level2">
<h2 class="anchored" data-anchor-id="null-scenario-permutation-test"><strong>Null Scenario: Permutation Test</strong></h2>
<p>Perhaps we are more interested in calculating a p-value to determine if the sample ratio differs from its underlying null distribution:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="sc">-</span> <span class="dv">1</span> <span class="co">#set number of times to complete permutation sampling</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>nP <span class="ot">&lt;-</span> <span class="fu">length</span>(placebo)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>obs_ratio <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo)<span class="sc">/</span><span class="fu">var</span>(vaccine) <span class="co"># calculate the ratio of the variances</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">612</span>) <span class="co">#set seed for reproducibility</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>pool_dat <span class="ot">&lt;-</span> <span class="fu">c</span>(placebo, vaccine)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pool_dat), <span class="at">size=</span>nP, <span class="at">replace=</span>F)</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    placebo_permute <span class="ot">&lt;-</span> pool_dat[index]</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    vaccine_permute <span class="ot">&lt;-</span> pool_dat[<span class="sc">-</span>index]</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    result[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo_permute) <span class="sc">/</span> <span class="fu">var</span>(vaccine_permute)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( result, <span class="at">xlab=</span><span class="st">'Var(Placebo) / Var(Vaccine)'</span>, </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">'Permutation Distribution for Ratio of Variances'</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">v=</span>obs_ratio, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Again, we see a distribution that is right skewed, and our observed ratio of variances falls fairly close to our expected null of 1. To calculate a <strong>two-sided p-value</strong> we would take the larger of the proportion of our distribution that falls above our observed ratio or, in our context, the proportion that falls below <code>1/obs_ratio</code> (the inverse of our observed ratio), and multiply it by 2:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#note, we take the larger p-value and multiply by 2 (as compared to replacing &lt;= with &gt;)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>((<span class="fu">sum</span>(result <span class="sc">&gt;=</span> obs_ratio) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3992</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>((<span class="fu">sum</span>(result <span class="sc">&lt;=</span> (<span class="dv">1</span><span class="sc">/</span>obs_ratio)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4009</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate permutation p-value for two-sided test</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> ((<span class="fu">sum</span>(result <span class="sc">&lt;=</span> (<span class="dv">1</span><span class="sc">/</span>obs_ratio)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8018</code></pre>
</div>
</div>
<p>Here we see that our two-sided p-value is 0.8018.</p>
<p>A few important notes here:</p>
<ul>
<li>It is helpful to plot the permutation distribution to note what direction (<span class="math inline">\(\leq\)</span> vs.&nbsp;<span class="math inline">\(\geq\)</span>) we need to use in our calculation.</li>
<li>We multiple the larger p-value by 2 to (1) account for the two-sided test and (2) to be more conservative (vs.&nbsp;using the smaller proportion).</li>
<li>If we wanted to calculate a <strong>one-sided p-value</strong> we would need to define that null and alternative hypothesis. For example, if our <span class="math inline">\(H_0\)</span> is that the ratio of variances is larger than 1 (i.e., the placebo group has larger variance), we would specifically interpret our result as <span class="math inline">\(p=0.3992\)</span>. If the null hypothesis is that the ratio of variance is smaller than 1, based on our observed ratio we would have <span class="math inline">\(1-0.3992=0.6008\)</span>.</li>
</ul>
</section>
<section id="alternative-scenario" class="level2">
<h2 class="anchored" data-anchor-id="alternative-scenario">Alternative Scenario</h2>
<p>Let’s check an alternative scenario, where we will simulate from: [ Y_{P} (=10, =3), ; Y_{T} (=5, =3) ] These parameters were chosen so that the placebo has a true variance of 90 and the vaccine has a true variance of 45 (i.e., the variance for the gamma distribution when parameterized with the shape (<span class="math inline">\(k\)</span>) and scale (<span class="math inline">\(\theta\)</span>) is <span class="math inline">\(k\theta^2\)</span>).</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">312</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>placebo <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">scale=</span><span class="dv">3</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>vaccine <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">5</span>, <span class="at">scale=</span><span class="dv">3</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(placebo) <span class="co"># calculate the sample variances</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 69.07464</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vaccine) <span class="co"># calculate the sample variances</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31.92498</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>obs_ratio <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo)<span class="sc">/</span><span class="fu">var</span>(vaccine) <span class="co"># calculate the ratio of the variances</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>obs_ratio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.163655</code></pre>
</div>
</div>
</section>
<section id="alternative-scenario-bootstrap" class="level2">
<h2 class="anchored" data-anchor-id="alternative-scenario-bootstrap"><strong>Alternative Scenario: Bootstrap</strong></h2>
<p>Let’s conduct a bootstrap with 10,000 resamples of our ratio of the sample variances to describe the variability of this statistic:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="co">#set number of bootstraps</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>var_ratio <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B) <span class="co">#initialize vector to store results in</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>nP <span class="ot">&lt;-</span> <span class="fu">length</span>(placebo) <span class="co">#sample size of placebo group</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>nT <span class="ot">&lt;-</span> <span class="fu">length</span>(vaccine) <span class="co">#sample size of vaccine group</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">312</span>) <span class="co">#set seed for reproducibility</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    placebo.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(placebo, nP, <span class="at">replace=</span>T)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    vaccine.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(vaccine, nT, <span class="at">replace=</span>T)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    var_ratio[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo.boot) <span class="sc">/</span> <span class="fu">var</span>(vaccine.boot)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s now visualize the shape of our bootstrap distribution:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co">#create plotting area for 2 figures in one row</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(var_ratio, <span class="at">main=</span><span class="st">'Bootstrap Dist. of</span><span class="sc">\n</span><span class="st">Var(Placebo)/Var(Vaccine)'</span>, <span class="at">xlab=</span><span class="st">'Placebo/Vaccine Variance Ratio'</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(var_ratio); <span class="fu">qqline</span>(var_ratio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The shapes of these plots suggest the ratio of variances is not normally distributed. Our histogram is right skewed and the normal Q-Q plot deviates from the diagonal line.</p>
<p>Let’s then calculate the mean, SE, and bias of the bootstrap distribution:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(var_ratio) <span class="co"># bootstrap mean ratio</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.398181</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(var_ratio)<span class="sc">-</span>obs_ratio <span class="co"># bias for ratio</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2345258</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(var_ratio) <span class="co"># bootstrap SE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9640094</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(var_ratio)<span class="sc">-</span>obs_ratio) <span class="sc">/</span> <span class="fu">sd</span>(var_ratio) <span class="co"># estimate of accuracy</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2432816</code></pre>
</div>
</div>
<p>The most concerning aspect of this is the bias/SE estimate &gt; 0.10, suggesting our bootstrap percentile intervals may not be very accurate. However, let’s calculate the 95% bootstrap percentile interval as our “best” approach given the two options from our lecture (i.e., normal percentile or bootstrap percentile):</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>( var_ratio, <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    2.5%    97.5% 
1.150953 4.786700 </code></pre>
</div>
</div>
<p>For the 95% bootstrap percentile CI, we are 95% confident that the true ratio of variances falls between 1.151 and 4.787. Additionally, because it is estimated from our data directly, 95% of the bootstrap estimates of ratios of variances fall in this interval.</p>
<p>The accuracy of our bootstrap percentile can be estimated by the ratio of the bias/SE, which we noted was 0.243. Since this exceeds +0.10 we may be concerned about the accuracy of this estimate.</p>
<p>It could also be noted that our 95% bootstrap percentile CI excludes 1, so we may conclude that we would reject the null hypothesis, and conclude our ratio of sample variances are not equal. Further, given the ratio as placebo/vaccine, we could conclude that the placebo has greater variability.</p>
</section>
<section id="alternative-scenario-permutation-test" class="level2">
<h2 class="anchored" data-anchor-id="alternative-scenario-permutation-test"><strong>Alternative Scenario: Permutation Test</strong></h2>
<p>Perhaps we are more interested in calculating a p-value to determine if the sample ratio differs from its underlying null distribution:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="sc">-</span> <span class="dv">1</span> <span class="co">#set number of times to complete permutation sampling</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>nP <span class="ot">&lt;-</span> <span class="fu">length</span>(placebo)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>obs_ratio <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo)<span class="sc">/</span><span class="fu">var</span>(vaccine) <span class="co"># calculate the ratio of the variances</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">312</span>) <span class="co">#set seed for reproducibility</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>pool_dat <span class="ot">&lt;-</span> <span class="fu">c</span>(placebo, vaccine)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pool_dat), <span class="at">size=</span>nP, <span class="at">replace=</span>F)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    placebo_permute <span class="ot">&lt;-</span> pool_dat[index]</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    vaccine_permute <span class="ot">&lt;-</span> pool_dat[<span class="sc">-</span>index]</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    result[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo_permute) <span class="sc">/</span> <span class="fu">var</span>(vaccine_permute)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( result, <span class="at">xlab=</span><span class="st">'Var(Placebo) / Var(Vaccine)'</span>, </span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">'Permutation Distribution for Ratio of Variances'</span>)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">v=</span>obs_ratio, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Again, we see a distribution that is right skewed, and our observed ratio of variances falls fairly close to our expected null of 1. To calculate a <strong>two-sided p-value</strong> we would take the larger of the proportion of our distribution that falls above our observed ratio or, in our context, the proportion that falls below <code>1/obs_ratio</code> (the inverse of our observed ratio), and multiply it by 2:</p>
<div class="cell">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#note, we take the larger p-value and multiply by 2 (as compared to replacing &lt;= with &gt;)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>((<span class="fu">sum</span>(result <span class="sc">&gt;=</span> obs_ratio) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6e-04</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>((<span class="fu">sum</span>(result <span class="sc">&lt;=</span> (<span class="dv">1</span><span class="sc">/</span>obs_ratio)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8e-04</code></pre>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r fold-show code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate permutation p-value for two-sided test</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> ((<span class="fu">sum</span>(result <span class="sc">&lt;=</span> (<span class="dv">1</span><span class="sc">/</span>obs_ratio)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0016</code></pre>
</div>
</div>
<p>Here we see that our two-sided p-value is 0.0016, so we would reject the null hypothesis that the variances are equal for placebo and vaccine groups.</p>
<p>A few important notes here:</p>
<ul>
<li>It is helpful to plot the permutation distribution to note what direction (<span class="math inline">\(\leq\)</span> vs.&nbsp;<span class="math inline">\(\geq\)</span>) we need to use in our calculation.</li>
<li>If we wanted to calculate a <strong>one-sided p-value</strong> we would need to define that null and alternative hypothesis. For example, if our <span class="math inline">\(H_0\)</span> is that the placebo has a larger variance than the vaccine group, we would conclude that the placebo group does appear to have a larger variance based on our one-sided <span class="math inline">\(p=0.0006\)</span>.</li>
<li>If the null hypothesis is that the vaccine has a larger variance than the placebo (i.e., the ratio is &lt;1), based on our observed ratio we would have <span class="math inline">\(p=1-0.0006=0.9994\)</span>, or we would fail to reject that null hypothesis. In other words, we cannot conclude that the vaccine group has a larger variance than the placebo.</li>
</ul>
</section>
<section id="wait-a-minute-what-is-the-distribution-of-the-ratio-of-variances" class="level2">
<h2 class="anchored" data-anchor-id="wait-a-minute-what-is-the-distribution-of-the-ratio-of-variances">Wait a Minute, What is the Distribution of the Ratio of Variances??</h2>
<p>Ahh, we almost snuck away without addressing the theoretical distribution! Generally speaking the ratio of variances will follow an <span class="math inline">\(F_{n_1-1,n_2-1}\)</span> distribution under the null hypothesis that the variances are equal:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r fold-hide code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">612</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>placebo <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">scale=</span><span class="dv">3</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>vaccine <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">5</span>, <span class="at">scale=</span><span class="fu">sqrt</span>(<span class="dv">18</span>))</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="sc">-</span> <span class="dv">1</span> <span class="co">#set number of times to complete permutation sampling</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>nP <span class="ot">&lt;-</span> <span class="fu">length</span>(placebo)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>obs_ratio <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo)<span class="sc">/</span><span class="fu">var</span>(vaccine) <span class="co"># calculate the ratio of the variances</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">612</span>) <span class="co">#set seed for reproducibility</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>pool_dat <span class="ot">&lt;-</span> <span class="fu">c</span>(placebo, vaccine)</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pool_dat), <span class="at">size=</span>nP, <span class="at">replace=</span>F)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>    placebo_permute <span class="ot">&lt;-</span> pool_dat[index]</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    vaccine_permute <span class="ot">&lt;-</span> pool_dat[<span class="sc">-</span>index]</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>    result[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo_permute) <span class="sc">/</span> <span class="fu">var</span>(vaccine_permute)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( result, <span class="at">xlab=</span><span class="st">'Var(Placebo) / Var(Vaccine)'</span>, </span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">'Permutation Distribution for Ratio of Variances'</span>, <span class="at">freq=</span>F, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">df</span>(x,<span class="at">df1=</span><span class="dv">49</span>,<span class="at">df2=</span><span class="dv">49</span>),<span class="at">add=</span>T, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">'orangered2'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb56" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Week 6 Lab"</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co">  name: Alex Kaizer</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co">  roles: "Instructor"</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co">  affiliation: University of Colorado-Anschutz Medical Campus</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="an">toc_float:</span><span class="co"> true</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="an">toc-location:</span><span class="co"> left</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-overflow: wrap </span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=F, message=F, warning=F}</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>This page is part of the University of Colorado-Anschutz Medical Campus' <span class="co">[</span><span class="ot">BIOS 6618 Labs</span><span class="co">](/labs/index.qmd)</span> collection, the mini-lecture content delivered at the start of class before breaking out into small groups to work on the homework assignment.</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="fu"># What's on the docket this week?</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>In Week 6 we are focusing on additional examples of bootstraps and permutation tests. Another helpful visual explainer of permutation tests is <span class="co">[</span><span class="ot">about being an alpaca shepherd</span><span class="co">](https://www.jwilber.me/permutationtest/)</span>.</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="fu"># A Colorful Illustration of Bootstraps and Permutations</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>There are a lot of similarities in between bootstraps and permutations:</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>both involve resampling (with replacement for bootstraps, without replacement for permutations)</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>both provide a means for evaluating the potential significance of a statistic (interpreting the confidence interval for bootstraps, interpreting a p-value for permutations)</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>both can be thought of as nonparametric approaches (i.e., we don't have to assume any underlying distribution to conduct a test)</span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>However, the nuances of sampling and what our ultimate goal for conducting either approach make them inherently different methods. If we strongly desire a p-value, we would implement a permutation test. Likewise, if we really wanted an estimate of the variability around a given statistic (e.g., its standard error or confidence interval), we would implement a bootstrap. </span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>These concepts can be challenging to "picture" when considering data cases. As a change of pace, let's consider the "average" color of a given sample.</span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Colorful Dataset</span></span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>Let's assume we have conducted a study with 6 observations in two groups, each represented by a color. Our "outcome" is the average color within the group (we can calculate this using the <span class="in">`average_colors()`</span> function from the <span class="in">`miscHelpers`</span> package that can be downloaded from GitHub):</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-hide', message=F}</span></span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this function to install the kableExtra package to create some tables</span></span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("haozhu233/kableExtra")</span></span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Run this function to install the miscHelpers package to use the average_colors() function</span></span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a><span class="co">#remotes::install_github("BenaroyaResearch/miscHelpers")</span></span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(miscHelpers)</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Create vectors to store colors in</span></span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>grp1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#0072B2'</span>,<span class="st">'#0072B2'</span>,<span class="st">'#0072B2'</span>,<span class="st">'#97C9E4'</span>,<span class="st">'#97C9E4'</span>,<span class="st">'#97C9E4'</span>) <span class="co"># vector with 2 blues</span></span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>grp2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'#F0E442'</span>,<span class="st">'#F0E442'</span>,<span class="st">'#F0E442'</span>,<span class="st">'#EA1F2F'</span>,<span class="st">'#EA1F2F'</span>,<span class="st">'#EA1F2F'</span>) <span class="co"># vector with reds and yellows</span></span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Create matrix for 1:6 (group 1) and A:F (group 2)</span></span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a>grp_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="st">'Avg. 1'</span>,<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'D'</span>,<span class="st">'E'</span>,<span class="st">'F'</span>,<span class="st">'Avg. 2'</span>), <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">byrow=</span>F, <span class="at">dimnames=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">'Observation '</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>),<span class="st">'Average'</span>), <span class="fu">c</span>(<span class="st">'Group 1'</span>,<span class="st">'Group 2'</span>)))</span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a>grp_mat <span class="sc">%&gt;%</span></span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align=</span><span class="st">'cc'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1, <span class="fu">average_colors</span>(grp1))) <span class="sc">%&gt;%</span></span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2, <span class="fu">average_colors</span>(grp2))) <span class="sc">%&gt;%</span></span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">6</span>, <span class="at">extra_css =</span> <span class="st">"border-bottom: 2px solid"</span>)</span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a>We can see in the above that the average color in Group 1 is a blue that is the "average" of the 3 light and 3 dark blues. For Group 2 the average of 3 yellows and 3 reds is orange.</span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a>Let's first see an example of bootstrap resampling. Remember, here we sample *within* each group and *with replacement*:</span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-hide'}</span></span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb56-78"><a href="#cb56-78" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">515</span>)</span>
<span id="cb56-79"><a href="#cb56-79" aria-hidden="true" tabindex="-1"></a>grp1b <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">replace=</span>T))</span>
<span id="cb56-80"><a href="#cb56-80" aria-hidden="true" tabindex="-1"></a>grp2b <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">replace=</span>T))</span>
<span id="cb56-81"><a href="#cb56-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-82"><a href="#cb56-82" aria-hidden="true" tabindex="-1"></a>grp_matb <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">c</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)[grp1b],<span class="st">'Avg. Boot 1'</span>,<span class="fu">c</span>(<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'D'</span>,<span class="st">'E'</span>,<span class="st">'F'</span>)[grp2b],<span class="st">'Avg. Boot 2'</span>), <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">byrow=</span>F)</span>
<span id="cb56-83"><a href="#cb56-83" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(grp_matb) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Boot Group 1'</span>,<span class="st">'Boot Group 2'</span>)</span>
<span id="cb56-84"><a href="#cb56-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-85"><a href="#cb56-85" aria-hidden="true" tabindex="-1"></a>grp_combo <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grp_mat, <span class="st">''</span>, grp_matb)</span>
<span id="cb56-86"><a href="#cb56-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-87"><a href="#cb56-87" aria-hidden="true" tabindex="-1"></a>grp_combo <span class="sc">%&gt;%</span></span>
<span id="cb56-88"><a href="#cb56-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align=</span><span class="st">'cc'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-89"><a href="#cb56-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb56-90"><a href="#cb56-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-91"><a href="#cb56-91" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1, <span class="fu">average_colors</span>(grp1))) <span class="sc">%&gt;%</span></span>
<span id="cb56-92"><a href="#cb56-92" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-93"><a href="#cb56-93" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2, <span class="fu">average_colors</span>(grp2))) <span class="sc">%&gt;%</span></span>
<span id="cb56-94"><a href="#cb56-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-95"><a href="#cb56-95" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1[grp1b], <span class="fu">average_colors</span>(grp1[grp1b]))) <span class="sc">%&gt;%</span></span>
<span id="cb56-96"><a href="#cb56-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">6</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-97"><a href="#cb56-97" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2[grp2b], <span class="fu">average_colors</span>(grp2[grp2b]))) <span class="sc">%&gt;%</span></span>
<span id="cb56-98"><a href="#cb56-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">6</span>, <span class="at">extra_css =</span> <span class="st">"border-bottom: 2px solid"</span>)</span>
<span id="cb56-99"><a href="#cb56-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-100"><a href="#cb56-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-101"><a href="#cb56-101" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>In this bootstrap, we see that Boot Group 1 has resampled the 4th observation twice, so the 5th "light blue" observation is not included in the sample. However, since both observation 4 and 5 are "light blue" the overall average color is unchanged!</span>
<span id="cb56-102"><a href="#cb56-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-103"><a href="#cb56-103" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>In this bootstrap, we see that Boot Group 2 has resampled each "A", "B", and "C" twice...leaving no red observations! In this case the bootstrap distribution is only yellow observations (one potential extreme) and our average is simply yellow.</span>
<span id="cb56-104"><a href="#cb56-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-105"><a href="#cb56-105" aria-hidden="true" tabindex="-1"></a>**How does this differ from a permutation test?**  For the permutation test we combine all 12 observations before resampling *without replacement* as to who belongs to which group:</span>
<span id="cb56-106"><a href="#cb56-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-107"><a href="#cb56-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-hide'}</span></span>
<span id="cb56-108"><a href="#cb56-108" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb56-109"><a href="#cb56-109" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1012</span>)</span>
<span id="cb56-110"><a href="#cb56-110" aria-hidden="true" tabindex="-1"></a>grp_perm <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">replace=</span>F)) <span class="co"># sample 6 observations to go into group 1, the rest will go into group 2</span></span>
<span id="cb56-111"><a href="#cb56-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-112"><a href="#cb56-112" aria-hidden="true" tabindex="-1"></a>grp1p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'D'</span>,<span class="st">'E'</span>,<span class="st">'F'</span>)[grp_perm] <span class="co"># take values according to index sampled for grp_perm</span></span>
<span id="cb56-113"><a href="#cb56-113" aria-hidden="true" tabindex="-1"></a>grp2p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'D'</span>,<span class="st">'E'</span>,<span class="st">'F'</span>)[<span class="sc">-</span>grp_perm] <span class="co"># remove values according to index sampled from grp_perm</span></span>
<span id="cb56-114"><a href="#cb56-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-115"><a href="#cb56-115" aria-hidden="true" tabindex="-1"></a>grp1p_col <span class="ot">&lt;-</span> <span class="fu">c</span>(grp1,grp2)[grp_perm]</span>
<span id="cb56-116"><a href="#cb56-116" aria-hidden="true" tabindex="-1"></a>grp2p_col <span class="ot">&lt;-</span> <span class="fu">c</span>(grp1,grp2)[<span class="sc">-</span>grp_perm]</span>
<span id="cb56-117"><a href="#cb56-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-118"><a href="#cb56-118" aria-hidden="true" tabindex="-1"></a>grp_matp <span class="ot">&lt;-</span> <span class="fu">matrix</span>( <span class="fu">c</span>(grp1p,<span class="st">'Avg. Perm 1'</span>,grp2p,<span class="st">'Avg. Perm 2'</span>), <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">byrow=</span>F)</span>
<span id="cb56-119"><a href="#cb56-119" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(grp_matp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Perm Group 1'</span>,<span class="st">'Perm Group 2'</span>)</span>
<span id="cb56-120"><a href="#cb56-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-121"><a href="#cb56-121" aria-hidden="true" tabindex="-1"></a>grp_combo2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(grp_combo, <span class="st">''</span>, grp_matp)</span>
<span id="cb56-122"><a href="#cb56-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-123"><a href="#cb56-123" aria-hidden="true" tabindex="-1"></a>grp_combo2 <span class="sc">%&gt;%</span></span>
<span id="cb56-124"><a href="#cb56-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">align=</span><span class="st">'cc'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-125"><a href="#cb56-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb56-126"><a href="#cb56-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-127"><a href="#cb56-127" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1, <span class="fu">average_colors</span>(grp1))) <span class="sc">%&gt;%</span></span>
<span id="cb56-128"><a href="#cb56-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-129"><a href="#cb56-129" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2, <span class="fu">average_colors</span>(grp2))) <span class="sc">%&gt;%</span></span>
<span id="cb56-130"><a href="#cb56-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-131"><a href="#cb56-131" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1[grp1b], <span class="fu">average_colors</span>(grp1[grp1b]))) <span class="sc">%&gt;%</span></span>
<span id="cb56-132"><a href="#cb56-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">6</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-133"><a href="#cb56-133" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2[grp2b], <span class="fu">average_colors</span>(grp2[grp2b]))) <span class="sc">%&gt;%</span></span>
<span id="cb56-134"><a href="#cb56-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">8</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-135"><a href="#cb56-135" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> <span class="fu">c</span>(grp1p_col, <span class="fu">average_colors</span>(grp1p_col))) <span class="sc">%&gt;%</span></span>
<span id="cb56-136"><a href="#cb56-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">9</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-137"><a href="#cb56-137" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> <span class="fu">c</span>(grp2p_col, <span class="fu">average_colors</span>(grp2p_col))) <span class="sc">%&gt;%</span></span>
<span id="cb56-138"><a href="#cb56-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">row_spec</span>(<span class="dv">6</span>, <span class="at">extra_css =</span> <span class="st">"border-bottom: 2px solid"</span>)</span>
<span id="cb56-139"><a href="#cb56-139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-140"><a href="#cb56-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-141"><a href="#cb56-141" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>In our permutation sample we see that group membership has been broken, so that members of the original Group 1 and Group 2 are now part of the Perm Group 1 and Perm Group 2. This process helps us to break any potential association that may have existed previously (e.g., only blues in one group versus red and yellows in another).</span>
<span id="cb56-142"><a href="#cb56-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-143"><a href="#cb56-143" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>We see our average colors are now an interesting brownish (Avg. Perm 1) and grayish-blue (Avg. Perm 2).</span>
<span id="cb56-144"><a href="#cb56-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-145"><a href="#cb56-145" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>If our original observation (e.g., the difference in sample means between groups) was actually from the *null distribution*, then we would expect that estimate to fall near the center of our permutation distribution. In our color example, the original colors are decided in our two camps (blue vs. red/yellow), so here we see a muddier picture of the average color.</span>
<span id="cb56-146"><a href="#cb56-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-147"><a href="#cb56-147" aria-hidden="true" tabindex="-1"></a>Based on either approach, we would want to conduct a large number of bootstrap or permutation resamples, and then examine the overall distribution:</span>
<span id="cb56-148"><a href="#cb56-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-149"><a href="#cb56-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-hide'}</span></span>
<span id="cb56-150"><a href="#cb56-150" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb56-151"><a href="#cb56-151" aria-hidden="true" tabindex="-1"></a>bp_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="st">''</span>, <span class="at">ncol=</span><span class="dv">5</span>,<span class="at">nrow=</span><span class="dv">100</span>)</span>
<span id="cb56-152"><a href="#cb56-152" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bp_mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Boot Group 1'</span>,<span class="st">'Boot Group 2'</span>,<span class="st">''</span>,<span class="st">'Perm Group 1'</span>,<span class="st">'Perm Group 2'</span>)</span>
<span id="cb56-153"><a href="#cb56-153" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(bp_mat) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'Simulation '</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb56-154"><a href="#cb56-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-155"><a href="#cb56-155" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb56-156"><a href="#cb56-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">2020</span><span class="sc">+</span>j)</span>
<span id="cb56-157"><a href="#cb56-157" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-158"><a href="#cb56-158" aria-hidden="true" tabindex="-1"></a>  <span class="co"># permutation resample</span></span>
<span id="cb56-159"><a href="#cb56-159" aria-hidden="true" tabindex="-1"></a>  grp_perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">replace=</span>F) <span class="co"># sample 6 observations to go into group 1, the rest will go into group 2</span></span>
<span id="cb56-160"><a href="#cb56-160" aria-hidden="true" tabindex="-1"></a>  bp_mat[j,<span class="st">'Perm Group 1'</span>] <span class="ot">&lt;-</span> <span class="fu">average_colors</span>(<span class="fu">c</span>(grp1,grp2)[grp_perm])</span>
<span id="cb56-161"><a href="#cb56-161" aria-hidden="true" tabindex="-1"></a>  bp_mat[j,<span class="st">'Perm Group 2'</span>] <span class="ot">&lt;-</span> <span class="fu">average_colors</span>(<span class="fu">c</span>(grp1,grp2)[<span class="sc">-</span>grp_perm])</span>
<span id="cb56-162"><a href="#cb56-162" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-163"><a href="#cb56-163" aria-hidden="true" tabindex="-1"></a>  <span class="co"># bootstrap resample</span></span>
<span id="cb56-164"><a href="#cb56-164" aria-hidden="true" tabindex="-1"></a>  bp_mat[j,<span class="st">'Boot Group 1'</span>] <span class="ot">&lt;-</span> <span class="fu">average_colors</span>( grp1[ <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">size=</span><span class="dv">6</span>,<span class="at">replace=</span>T) ])</span>
<span id="cb56-165"><a href="#cb56-165" aria-hidden="true" tabindex="-1"></a>  bp_mat[j,<span class="st">'Boot Group 2'</span>] <span class="ot">&lt;-</span> <span class="fu">average_colors</span>( grp2[ <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="at">size=</span><span class="dv">6</span>,<span class="at">replace=</span>T) ])</span>
<span id="cb56-166"><a href="#cb56-166" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-167"><a href="#cb56-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-168"><a href="#cb56-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Object to create kable from</span></span>
<span id="cb56-169"><a href="#cb56-169" aria-hidden="true" tabindex="-1"></a>bp_mat_kableshell <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="st">''</span>, <span class="at">ncol=</span><span class="dv">5</span>,<span class="at">nrow=</span><span class="dv">100</span>)</span>
<span id="cb56-170"><a href="#cb56-170" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bp_mat_kableshell) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Boot Group 1'</span>,<span class="st">'Boot Group 2'</span>,<span class="st">''</span>,<span class="st">'Perm Group 1'</span>,<span class="st">'Perm Group 2'</span>)</span>
<span id="cb56-171"><a href="#cb56-171" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(bp_mat_kableshell) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">'Simulation '</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb56-172"><a href="#cb56-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-173"><a href="#cb56-173" aria-hidden="true" tabindex="-1"></a>bp_mat_kableshell <span class="sc">%&gt;%</span></span>
<span id="cb56-174"><a href="#cb56-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb56-175"><a href="#cb56-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_paper</span>(<span class="at">full_width =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb56-176"><a href="#cb56-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-177"><a href="#cb56-177" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> bp_mat[,<span class="st">'Boot Group 1'</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb56-178"><a href="#cb56-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-179"><a href="#cb56-179" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> bp_mat[,<span class="st">'Boot Group 2'</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb56-180"><a href="#cb56-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-181"><a href="#cb56-181" aria-hidden="true" tabindex="-1"></a>            <span class="at">background =</span> bp_mat[,<span class="st">'Perm Group 1'</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb56-182"><a href="#cb56-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">6</span>, <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb56-183"><a href="#cb56-183" aria-hidden="true" tabindex="-1"></a>              <span class="at">background =</span> bp_mat[,<span class="st">'Perm Group 2'</span>])</span>
<span id="cb56-184"><a href="#cb56-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-185"><a href="#cb56-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-186"><a href="#cb56-186" aria-hidden="true" tabindex="-1"></a>If this were an actual study with a numeric outcome we could describe the variability of our average color within or between groups (**bootstrap sampling**) or we could calculate if our observed data is more extreme than the null/permutation distribution (**permutation test**).</span>
<span id="cb56-187"><a href="#cb56-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-188"><a href="#cb56-188" aria-hidden="true" tabindex="-1"></a>Indeed we can see that for all 100 bootstrap samples, there are various shades of blue for Group 1 and red/orange/yellow for Group 2. Whereas for all 100 permutation samples there is a range of colors from purpleish to blueish to orangeish to greenish...a random combination of our colors!</span>
<span id="cb56-189"><a href="#cb56-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-190"><a href="#cb56-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-191"><a href="#cb56-191" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bootstrap and Permutation Test Example: The Ratio of Sample Variances</span></span>
<span id="cb56-192"><a href="#cb56-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-193"><a href="#cb56-193" aria-hidden="true" tabindex="-1"></a>Assume we have conducted a randomized trial that enrolled 100 total participants with celiac disease to examine the potential effect of a new vaccine ($T$) to desensitize the immune system in its reaction to gluten as compared to a placebo ($P$). The outcome is the measure of the tissue transglutaminase IgA antibody (tTG-IgA).</span>
<span id="cb56-194"><a href="#cb56-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-195"><a href="#cb56-195" aria-hidden="true" tabindex="-1"></a>As a secondary analysis of the primary trial, we wish to explore if the variability of tTG-IgA in the two groups with 50 participants each are approximately equal, even if their mean tTG-IgA concentrations are different. To evaluate this, we propose using the ratio of the placebo to the treatment group: </span>
<span id="cb56-196"><a href="#cb56-196" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span> \frac{s_{P}^2}{s_{T}^2} <span class="sc">\]</span> </span>
<span id="cb56-197"><a href="#cb56-197" aria-hidden="true" tabindex="-1"></a>If the ratio is equal to 1, our estimates are the same (i.e., our null hypothesis). Let's assume that we have zero idea what distribution this may take, so we want to explore using bootstraps to describe the variability or a permutation test to calculate a p-value summary if our sample is unexpected.</span>
<span id="cb56-198"><a href="#cb56-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-199"><a href="#cb56-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-200"><a href="#cb56-200" aria-hidden="true" tabindex="-1"></a><span class="fu">## Null Scenario</span></span>
<span id="cb56-201"><a href="#cb56-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-202"><a href="#cb56-202" aria-hidden="true" tabindex="-1"></a>Let's start with the null scenario, where both groups have the same variance. We will simulate from:</span>
<span id="cb56-203"><a href="#cb56-203" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span> Y_{P} \sim \text{Gamma}(\text{shape}=10, \text{scale}=3), \; Y_{T} \sim \text{Gamma}(\text{shape}=5, \text{scale}=\sqrt{18})  <span class="sc">\]</span></span>
<span id="cb56-204"><a href="#cb56-204" aria-hidden="true" tabindex="-1"></a>These parameters were chosen so that both sets of data will have a variance of 90 (i.e., the variance for the gamma distribution when parameterized with the shape ($k$) and scale ($\theta$) is $k\theta^2$).</span>
<span id="cb56-205"><a href="#cb56-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-206"><a href="#cb56-206" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-207"><a href="#cb56-207" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">612</span>)</span>
<span id="cb56-208"><a href="#cb56-208" aria-hidden="true" tabindex="-1"></a>placebo <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">scale=</span><span class="dv">3</span>)</span>
<span id="cb56-209"><a href="#cb56-209" aria-hidden="true" tabindex="-1"></a>vaccine <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">5</span>, <span class="at">scale=</span><span class="fu">sqrt</span>(<span class="dv">18</span>))</span>
<span id="cb56-210"><a href="#cb56-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-211"><a href="#cb56-211" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(placebo) <span class="co"># calculate the sample variances</span></span>
<span id="cb56-212"><a href="#cb56-212" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vaccine) <span class="co"># calculate the sample variances</span></span>
<span id="cb56-213"><a href="#cb56-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-214"><a href="#cb56-214" aria-hidden="true" tabindex="-1"></a>obs_ratio <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo)<span class="sc">/</span><span class="fu">var</span>(vaccine) <span class="co"># calculate the ratio of the variances</span></span>
<span id="cb56-215"><a href="#cb56-215" aria-hidden="true" tabindex="-1"></a>obs_ratio</span>
<span id="cb56-216"><a href="#cb56-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-217"><a href="#cb56-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-218"><a href="#cb56-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-219"><a href="#cb56-219" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Null Scenario: Bootstrap**</span></span>
<span id="cb56-220"><a href="#cb56-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-221"><a href="#cb56-221" aria-hidden="true" tabindex="-1"></a>Let's conduct a bootstrap with 10,000 resamples of our ratio of the sample variances to describe the variability of this statistic:</span>
<span id="cb56-222"><a href="#cb56-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-223"><a href="#cb56-223" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="co">#set number of bootstraps</span></span>
<span id="cb56-224"><a href="#cb56-224" aria-hidden="true" tabindex="-1"></a>var_ratio <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B) <span class="co">#initialize vector to store results in</span></span>
<span id="cb56-225"><a href="#cb56-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-226"><a href="#cb56-226" aria-hidden="true" tabindex="-1"></a>nP <span class="ot">&lt;-</span> <span class="fu">length</span>(placebo) <span class="co">#sample size of placebo group</span></span>
<span id="cb56-227"><a href="#cb56-227" aria-hidden="true" tabindex="-1"></a>nT <span class="ot">&lt;-</span> <span class="fu">length</span>(vaccine) <span class="co">#sample size of vaccine group</span></span>
<span id="cb56-228"><a href="#cb56-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-229"><a href="#cb56-229" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">612</span>) <span class="co">#set seed for reproducibility</span></span>
<span id="cb56-230"><a href="#cb56-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-231"><a href="#cb56-231" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb56-232"><a href="#cb56-232" aria-hidden="true" tabindex="-1"></a>    placebo.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(placebo, nP, <span class="at">replace=</span>T)</span>
<span id="cb56-233"><a href="#cb56-233" aria-hidden="true" tabindex="-1"></a>    vaccine.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(vaccine, nT, <span class="at">replace=</span>T)</span>
<span id="cb56-234"><a href="#cb56-234" aria-hidden="true" tabindex="-1"></a>    var_ratio[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo.boot) <span class="sc">/</span> <span class="fu">var</span>(vaccine.boot)</span>
<span id="cb56-235"><a href="#cb56-235" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-236"><a href="#cb56-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-237"><a href="#cb56-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-238"><a href="#cb56-238" aria-hidden="true" tabindex="-1"></a>Let's now visualize the shape of our bootstrap distribution:</span>
<span id="cb56-239"><a href="#cb56-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-240"><a href="#cb56-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-241"><a href="#cb56-241" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co">#create plotting area for 2 figures in one row</span></span>
<span id="cb56-242"><a href="#cb56-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-243"><a href="#cb56-243" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(var_ratio, <span class="at">main=</span><span class="st">'Bootstrap Dist. of</span><span class="sc">\n</span><span class="st">Var(Placebo)/Var(Vaccine)'</span>, <span class="at">xlab=</span><span class="st">'Placebo/Vaccine Variance Ratio'</span>)</span>
<span id="cb56-244"><a href="#cb56-244" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(var_ratio); <span class="fu">qqline</span>(var_ratio)</span>
<span id="cb56-245"><a href="#cb56-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-246"><a href="#cb56-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-247"><a href="#cb56-247" aria-hidden="true" tabindex="-1"></a>The shapes of these plots suggest the ratio of variances is not normally distributed. Our histogram is right skewed and the normal Q-Q plot deviates from the diagonal line.</span>
<span id="cb56-248"><a href="#cb56-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-249"><a href="#cb56-249" aria-hidden="true" tabindex="-1"></a>Let's then calculate the mean, SE, and bias of the bootstrap distribution:</span>
<span id="cb56-250"><a href="#cb56-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-251"><a href="#cb56-251" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-252"><a href="#cb56-252" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(var_ratio) <span class="co"># bootstrap mean ratio</span></span>
<span id="cb56-253"><a href="#cb56-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-254"><a href="#cb56-254" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(var_ratio)<span class="sc">-</span>obs_ratio <span class="co"># bias for ratio</span></span>
<span id="cb56-255"><a href="#cb56-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-256"><a href="#cb56-256" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(var_ratio) <span class="co"># bootstrap SE</span></span>
<span id="cb56-257"><a href="#cb56-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-258"><a href="#cb56-258" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(var_ratio)<span class="sc">-</span>obs_ratio) <span class="sc">/</span> <span class="fu">sd</span>(var_ratio) <span class="co"># estimate of accuracy</span></span>
<span id="cb56-259"><a href="#cb56-259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-260"><a href="#cb56-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-261"><a href="#cb56-261" aria-hidden="true" tabindex="-1"></a>The most concerning aspect of this is the bias/SE estimate &gt; 0.10, suggesting our bootstrap percentile intervals may not be very accurate. However, let's calculate the 95% bootstrap percentile interval as our "best" approach given the two options from our lecture (i.e., normal percentile or bootstrap percentile):</span>
<span id="cb56-262"><a href="#cb56-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-263"><a href="#cb56-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-264"><a href="#cb56-264" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>( var_ratio, <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span>
<span id="cb56-265"><a href="#cb56-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-266"><a href="#cb56-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-267"><a href="#cb56-267" aria-hidden="true" tabindex="-1"></a>For the 95% bootstrap percentile CI, we are 95% confident that the true ratio of variances falls between 0.546 and 2.269. Additionally, because it is estimated from our data directly, 95% of the bootstrap estimates of ratios of variances fall in this interval. </span>
<span id="cb56-268"><a href="#cb56-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-269"><a href="#cb56-269" aria-hidden="true" tabindex="-1"></a>The accuracy of our bootstrap percentile can be estimated by the ratio of the bias/SE, which we noted was 0.215. Since this exceeds +0.10 we may be concerned about the accuracy of this estimate.</span>
<span id="cb56-270"><a href="#cb56-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-271"><a href="#cb56-271" aria-hidden="true" tabindex="-1"></a>It could also be noted that our 95% bootstrap percentile CI includes 1, so we would fail to reject the null hypothesis.</span>
<span id="cb56-272"><a href="#cb56-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-273"><a href="#cb56-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-274"><a href="#cb56-274" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Null Scenario: Permutation Test**</span></span>
<span id="cb56-275"><a href="#cb56-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-276"><a href="#cb56-276" aria-hidden="true" tabindex="-1"></a>Perhaps we are more interested in calculating a p-value to determine if the sample ratio differs from its underlying null distribution:</span>
<span id="cb56-277"><a href="#cb56-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-278"><a href="#cb56-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-279"><a href="#cb56-279" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="sc">-</span> <span class="dv">1</span> <span class="co">#set number of times to complete permutation sampling</span></span>
<span id="cb56-280"><a href="#cb56-280" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb56-281"><a href="#cb56-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-282"><a href="#cb56-282" aria-hidden="true" tabindex="-1"></a>nP <span class="ot">&lt;-</span> <span class="fu">length</span>(placebo)</span>
<span id="cb56-283"><a href="#cb56-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-284"><a href="#cb56-284" aria-hidden="true" tabindex="-1"></a>obs_ratio <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo)<span class="sc">/</span><span class="fu">var</span>(vaccine) <span class="co"># calculate the ratio of the variances</span></span>
<span id="cb56-285"><a href="#cb56-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-286"><a href="#cb56-286" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">612</span>) <span class="co">#set seed for reproducibility</span></span>
<span id="cb56-287"><a href="#cb56-287" aria-hidden="true" tabindex="-1"></a>pool_dat <span class="ot">&lt;-</span> <span class="fu">c</span>(placebo, vaccine)</span>
<span id="cb56-288"><a href="#cb56-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-289"><a href="#cb56-289" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb56-290"><a href="#cb56-290" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pool_dat), <span class="at">size=</span>nP, <span class="at">replace=</span>F)</span>
<span id="cb56-291"><a href="#cb56-291" aria-hidden="true" tabindex="-1"></a>    placebo_permute <span class="ot">&lt;-</span> pool_dat[index]</span>
<span id="cb56-292"><a href="#cb56-292" aria-hidden="true" tabindex="-1"></a>    vaccine_permute <span class="ot">&lt;-</span> pool_dat[<span class="sc">-</span>index]</span>
<span id="cb56-293"><a href="#cb56-293" aria-hidden="true" tabindex="-1"></a>    result[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo_permute) <span class="sc">/</span> <span class="fu">var</span>(vaccine_permute)</span>
<span id="cb56-294"><a href="#cb56-294" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-295"><a href="#cb56-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-296"><a href="#cb56-296" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb56-297"><a href="#cb56-297" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( result, <span class="at">xlab=</span><span class="st">'Var(Placebo) / Var(Vaccine)'</span>, </span>
<span id="cb56-298"><a href="#cb56-298" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">'Permutation Distribution for Ratio of Variances'</span>)</span>
<span id="cb56-299"><a href="#cb56-299" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">v=</span>obs_ratio, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb56-300"><a href="#cb56-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-301"><a href="#cb56-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-302"><a href="#cb56-302" aria-hidden="true" tabindex="-1"></a>Again, we see a distribution that is right skewed, and our observed ratio of variances falls fairly close to our expected null of 1. To calculate a **two-sided p-value** we would take the larger of the proportion of our distribution that falls above our observed ratio or, in our context, the proportion that falls below <span class="in">`1/obs_ratio`</span> (the inverse of our observed ratio), and multiply it by 2:</span>
<span id="cb56-303"><a href="#cb56-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-304"><a href="#cb56-304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-305"><a href="#cb56-305" aria-hidden="true" tabindex="-1"></a><span class="co">#note, we take the larger p-value and multiply by 2 (as compared to replacing &lt;= with &gt;)</span></span>
<span id="cb56-306"><a href="#cb56-306" aria-hidden="true" tabindex="-1"></a>((<span class="fu">sum</span>(result <span class="sc">&gt;=</span> obs_ratio) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb56-307"><a href="#cb56-307" aria-hidden="true" tabindex="-1"></a>((<span class="fu">sum</span>(result <span class="sc">&lt;=</span> (<span class="dv">1</span><span class="sc">/</span>obs_ratio)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb56-308"><a href="#cb56-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-309"><a href="#cb56-309" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate permutation p-value for two-sided test</span></span>
<span id="cb56-310"><a href="#cb56-310" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> ((<span class="fu">sum</span>(result <span class="sc">&lt;=</span> (<span class="dv">1</span><span class="sc">/</span>obs_ratio)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>)) </span>
<span id="cb56-311"><a href="#cb56-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-312"><a href="#cb56-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-313"><a href="#cb56-313" aria-hidden="true" tabindex="-1"></a>Here we see that our two-sided p-value is 0.8018.</span>
<span id="cb56-314"><a href="#cb56-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-315"><a href="#cb56-315" aria-hidden="true" tabindex="-1"></a>A few important notes here:</span>
<span id="cb56-316"><a href="#cb56-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-317"><a href="#cb56-317" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>It is helpful to plot the permutation distribution to note what direction ($\leq$ vs. $\geq$) we need to use in our calculation.</span>
<span id="cb56-318"><a href="#cb56-318" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>We multiple the larger p-value by 2 to (1) account for the two-sided test and (2) to be more conservative (vs. using the smaller proportion).</span>
<span id="cb56-319"><a href="#cb56-319" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>If we wanted to calculate a **one-sided p-value** we would need to define that null and alternative hypothesis. For example, if our $H_0$ is that the ratio of variances is larger than 1 (i.e., the placebo group has larger variance), we would specifically interpret our result as $p=0.3992$. If the null hypothesis is that the ratio of variance is smaller than 1, based on our observed ratio we would have $1-0.3992=0.6008$.</span>
<span id="cb56-320"><a href="#cb56-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-321"><a href="#cb56-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-322"><a href="#cb56-322" aria-hidden="true" tabindex="-1"></a><span class="fu">## Alternative Scenario</span></span>
<span id="cb56-323"><a href="#cb56-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-324"><a href="#cb56-324" aria-hidden="true" tabindex="-1"></a>Let's check an alternative scenario, where we will simulate from:</span>
<span id="cb56-325"><a href="#cb56-325" aria-hidden="true" tabindex="-1"></a><span class="sc">\[</span> Y_{P} \sim \text{Gamma}(\text{shape}=10, \text{scale}=3), \; Y_{T} \sim \text{Gamma}(\text{shape}=5, \text{scale}=3)  <span class="sc">\]</span></span>
<span id="cb56-326"><a href="#cb56-326" aria-hidden="true" tabindex="-1"></a>These parameters were chosen so that the placebo has a true variance of 90 and the vaccine has a true variance of 45 (i.e., the variance for the gamma distribution when parameterized with the shape ($k$) and scale ($\theta$) is $k\theta^2$).</span>
<span id="cb56-327"><a href="#cb56-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-328"><a href="#cb56-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-329"><a href="#cb56-329" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">312</span>)</span>
<span id="cb56-330"><a href="#cb56-330" aria-hidden="true" tabindex="-1"></a>placebo <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">scale=</span><span class="dv">3</span>)</span>
<span id="cb56-331"><a href="#cb56-331" aria-hidden="true" tabindex="-1"></a>vaccine <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">5</span>, <span class="at">scale=</span><span class="dv">3</span>)</span>
<span id="cb56-332"><a href="#cb56-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-333"><a href="#cb56-333" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(placebo) <span class="co"># calculate the sample variances</span></span>
<span id="cb56-334"><a href="#cb56-334" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(vaccine) <span class="co"># calculate the sample variances</span></span>
<span id="cb56-335"><a href="#cb56-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-336"><a href="#cb56-336" aria-hidden="true" tabindex="-1"></a>obs_ratio <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo)<span class="sc">/</span><span class="fu">var</span>(vaccine) <span class="co"># calculate the ratio of the variances</span></span>
<span id="cb56-337"><a href="#cb56-337" aria-hidden="true" tabindex="-1"></a>obs_ratio</span>
<span id="cb56-338"><a href="#cb56-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-339"><a href="#cb56-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-340"><a href="#cb56-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-341"><a href="#cb56-341" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Alternative Scenario: Bootstrap**</span></span>
<span id="cb56-342"><a href="#cb56-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-343"><a href="#cb56-343" aria-hidden="true" tabindex="-1"></a>Let's conduct a bootstrap with 10,000 resamples of our ratio of the sample variances to describe the variability of this statistic:</span>
<span id="cb56-344"><a href="#cb56-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-345"><a href="#cb56-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-346"><a href="#cb56-346" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="co">#set number of bootstraps</span></span>
<span id="cb56-347"><a href="#cb56-347" aria-hidden="true" tabindex="-1"></a>var_ratio <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B) <span class="co">#initialize vector to store results in</span></span>
<span id="cb56-348"><a href="#cb56-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-349"><a href="#cb56-349" aria-hidden="true" tabindex="-1"></a>nP <span class="ot">&lt;-</span> <span class="fu">length</span>(placebo) <span class="co">#sample size of placebo group</span></span>
<span id="cb56-350"><a href="#cb56-350" aria-hidden="true" tabindex="-1"></a>nT <span class="ot">&lt;-</span> <span class="fu">length</span>(vaccine) <span class="co">#sample size of vaccine group</span></span>
<span id="cb56-351"><a href="#cb56-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-352"><a href="#cb56-352" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">312</span>) <span class="co">#set seed for reproducibility</span></span>
<span id="cb56-353"><a href="#cb56-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-354"><a href="#cb56-354" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb56-355"><a href="#cb56-355" aria-hidden="true" tabindex="-1"></a>    placebo.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(placebo, nP, <span class="at">replace=</span>T)</span>
<span id="cb56-356"><a href="#cb56-356" aria-hidden="true" tabindex="-1"></a>    vaccine.boot <span class="ot">&lt;-</span> <span class="fu">sample</span>(vaccine, nT, <span class="at">replace=</span>T)</span>
<span id="cb56-357"><a href="#cb56-357" aria-hidden="true" tabindex="-1"></a>    var_ratio[i] <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo.boot) <span class="sc">/</span> <span class="fu">var</span>(vaccine.boot)</span>
<span id="cb56-358"><a href="#cb56-358" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-359"><a href="#cb56-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-360"><a href="#cb56-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-361"><a href="#cb56-361" aria-hidden="true" tabindex="-1"></a>Let's now visualize the shape of our bootstrap distribution:</span>
<span id="cb56-362"><a href="#cb56-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-363"><a href="#cb56-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-364"><a href="#cb56-364" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="co">#create plotting area for 2 figures in one row</span></span>
<span id="cb56-365"><a href="#cb56-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-366"><a href="#cb56-366" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(var_ratio, <span class="at">main=</span><span class="st">'Bootstrap Dist. of</span><span class="sc">\n</span><span class="st">Var(Placebo)/Var(Vaccine)'</span>, <span class="at">xlab=</span><span class="st">'Placebo/Vaccine Variance Ratio'</span>)</span>
<span id="cb56-367"><a href="#cb56-367" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(var_ratio); <span class="fu">qqline</span>(var_ratio)</span>
<span id="cb56-368"><a href="#cb56-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-369"><a href="#cb56-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-370"><a href="#cb56-370" aria-hidden="true" tabindex="-1"></a>The shapes of these plots suggest the ratio of variances is not normally distributed. Our histogram is right skewed and the normal Q-Q plot deviates from the diagonal line.</span>
<span id="cb56-371"><a href="#cb56-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-372"><a href="#cb56-372" aria-hidden="true" tabindex="-1"></a>Let's then calculate the mean, SE, and bias of the bootstrap distribution:</span>
<span id="cb56-373"><a href="#cb56-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-374"><a href="#cb56-374" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-375"><a href="#cb56-375" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(var_ratio) <span class="co"># bootstrap mean ratio</span></span>
<span id="cb56-376"><a href="#cb56-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-377"><a href="#cb56-377" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(var_ratio)<span class="sc">-</span>obs_ratio <span class="co"># bias for ratio</span></span>
<span id="cb56-378"><a href="#cb56-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-379"><a href="#cb56-379" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(var_ratio) <span class="co"># bootstrap SE</span></span>
<span id="cb56-380"><a href="#cb56-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-381"><a href="#cb56-381" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(var_ratio)<span class="sc">-</span>obs_ratio) <span class="sc">/</span> <span class="fu">sd</span>(var_ratio) <span class="co"># estimate of accuracy</span></span>
<span id="cb56-382"><a href="#cb56-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-383"><a href="#cb56-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-384"><a href="#cb56-384" aria-hidden="true" tabindex="-1"></a>The most concerning aspect of this is the bias/SE estimate &gt; 0.10, suggesting our bootstrap percentile intervals may not be very accurate. However, let's calculate the 95% bootstrap percentile interval as our "best" approach given the two options from our lecture (i.e., normal percentile or bootstrap percentile):</span>
<span id="cb56-385"><a href="#cb56-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-386"><a href="#cb56-386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-387"><a href="#cb56-387" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>( var_ratio, <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.975</span>))</span>
<span id="cb56-388"><a href="#cb56-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-389"><a href="#cb56-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-390"><a href="#cb56-390" aria-hidden="true" tabindex="-1"></a>For the 95% bootstrap percentile CI, we are 95% confident that the true ratio of variances falls between 1.151 and 4.787. Additionally, because it is estimated from our data directly, 95% of the bootstrap estimates of ratios of variances fall in this interval. </span>
<span id="cb56-391"><a href="#cb56-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-392"><a href="#cb56-392" aria-hidden="true" tabindex="-1"></a>The accuracy of our bootstrap percentile can be estimated by the ratio of the bias/SE, which we noted was 0.243. Since this exceeds +0.10 we may be concerned about the accuracy of this estimate.</span>
<span id="cb56-393"><a href="#cb56-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-394"><a href="#cb56-394" aria-hidden="true" tabindex="-1"></a>It could also be noted that our 95% bootstrap percentile CI excludes 1, so we may conclude that we would reject the null hypothesis, and conclude our ratio of sample variances are not equal. Further, given the ratio as placebo/vaccine, we could conclude that the placebo has greater variability.</span>
<span id="cb56-395"><a href="#cb56-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-396"><a href="#cb56-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-397"><a href="#cb56-397" aria-hidden="true" tabindex="-1"></a><span class="fu">## **Alternative Scenario: Permutation Test**</span></span>
<span id="cb56-398"><a href="#cb56-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-399"><a href="#cb56-399" aria-hidden="true" tabindex="-1"></a>Perhaps we are more interested in calculating a p-value to determine if the sample ratio differs from its underlying null distribution:</span>
<span id="cb56-400"><a href="#cb56-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-401"><a href="#cb56-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-402"><a href="#cb56-402" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="sc">-</span> <span class="dv">1</span> <span class="co">#set number of times to complete permutation sampling</span></span>
<span id="cb56-403"><a href="#cb56-403" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb56-404"><a href="#cb56-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-405"><a href="#cb56-405" aria-hidden="true" tabindex="-1"></a>nP <span class="ot">&lt;-</span> <span class="fu">length</span>(placebo)</span>
<span id="cb56-406"><a href="#cb56-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-407"><a href="#cb56-407" aria-hidden="true" tabindex="-1"></a>obs_ratio <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo)<span class="sc">/</span><span class="fu">var</span>(vaccine) <span class="co"># calculate the ratio of the variances</span></span>
<span id="cb56-408"><a href="#cb56-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-409"><a href="#cb56-409" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">312</span>) <span class="co">#set seed for reproducibility</span></span>
<span id="cb56-410"><a href="#cb56-410" aria-hidden="true" tabindex="-1"></a>pool_dat <span class="ot">&lt;-</span> <span class="fu">c</span>(placebo, vaccine)</span>
<span id="cb56-411"><a href="#cb56-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-412"><a href="#cb56-412" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb56-413"><a href="#cb56-413" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pool_dat), <span class="at">size=</span>nP, <span class="at">replace=</span>F)</span>
<span id="cb56-414"><a href="#cb56-414" aria-hidden="true" tabindex="-1"></a>    placebo_permute <span class="ot">&lt;-</span> pool_dat[index]</span>
<span id="cb56-415"><a href="#cb56-415" aria-hidden="true" tabindex="-1"></a>    vaccine_permute <span class="ot">&lt;-</span> pool_dat[<span class="sc">-</span>index]</span>
<span id="cb56-416"><a href="#cb56-416" aria-hidden="true" tabindex="-1"></a>    result[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo_permute) <span class="sc">/</span> <span class="fu">var</span>(vaccine_permute)</span>
<span id="cb56-417"><a href="#cb56-417" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-418"><a href="#cb56-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-419"><a href="#cb56-419" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb56-420"><a href="#cb56-420" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( result, <span class="at">xlab=</span><span class="st">'Var(Placebo) / Var(Vaccine)'</span>, </span>
<span id="cb56-421"><a href="#cb56-421" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">'Permutation Distribution for Ratio of Variances'</span>)</span>
<span id="cb56-422"><a href="#cb56-422" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">v=</span>obs_ratio, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb56-423"><a href="#cb56-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-424"><a href="#cb56-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-425"><a href="#cb56-425" aria-hidden="true" tabindex="-1"></a>Again, we see a distribution that is right skewed, and our observed ratio of variances falls fairly close to our expected null of 1. To calculate a **two-sided p-value** we would take the larger of the proportion of our distribution that falls above our observed ratio or, in our context, the proportion that falls below <span class="in">`1/obs_ratio`</span> (the inverse of our observed ratio), and multiply it by 2:</span>
<span id="cb56-426"><a href="#cb56-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-427"><a href="#cb56-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-show'}</span></span>
<span id="cb56-428"><a href="#cb56-428" aria-hidden="true" tabindex="-1"></a><span class="co">#note, we take the larger p-value and multiply by 2 (as compared to replacing &lt;= with &gt;)</span></span>
<span id="cb56-429"><a href="#cb56-429" aria-hidden="true" tabindex="-1"></a>((<span class="fu">sum</span>(result <span class="sc">&gt;=</span> obs_ratio) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb56-430"><a href="#cb56-430" aria-hidden="true" tabindex="-1"></a>((<span class="fu">sum</span>(result <span class="sc">&lt;=</span> (<span class="dv">1</span><span class="sc">/</span>obs_ratio)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb56-431"><a href="#cb56-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-432"><a href="#cb56-432" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate permutation p-value for two-sided test</span></span>
<span id="cb56-433"><a href="#cb56-433" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">*</span> ((<span class="fu">sum</span>(result <span class="sc">&lt;=</span> (<span class="dv">1</span><span class="sc">/</span>obs_ratio)) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">/</span>(B<span class="sc">+</span><span class="dv">1</span>)) </span>
<span id="cb56-434"><a href="#cb56-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-435"><a href="#cb56-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-436"><a href="#cb56-436" aria-hidden="true" tabindex="-1"></a>Here we see that our two-sided p-value is 0.0016, so we would reject the null hypothesis that the variances are equal for placebo and vaccine groups.</span>
<span id="cb56-437"><a href="#cb56-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-438"><a href="#cb56-438" aria-hidden="true" tabindex="-1"></a>A few important notes here:</span>
<span id="cb56-439"><a href="#cb56-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-440"><a href="#cb56-440" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>It is helpful to plot the permutation distribution to note what direction ($\leq$ vs. $\geq$) we need to use in our calculation.</span>
<span id="cb56-441"><a href="#cb56-441" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>If we wanted to calculate a **one-sided p-value** we would need to define that null and alternative hypothesis. For example, if our $H_0$ is that the placebo has a larger variance than the vaccine group, we would conclude that the placebo group does appear to have a larger variance based on our one-sided $p=0.0006$. </span>
<span id="cb56-442"><a href="#cb56-442" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>If the null hypothesis is that the vaccine has a larger variance than the placebo (i.e., the ratio is &lt;1), based on our observed ratio we would have $p=1-0.0006=0.9994$, or we would fail to reject that null hypothesis. In other words, we cannot conclude that the vaccine group has a larger variance than the placebo.</span>
<span id="cb56-443"><a href="#cb56-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-444"><a href="#cb56-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-445"><a href="#cb56-445" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wait a Minute, What is the Distribution of the Ratio of Variances??</span></span>
<span id="cb56-446"><a href="#cb56-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-447"><a href="#cb56-447" aria-hidden="true" tabindex="-1"></a>Ahh, we almost snuck away without addressing the theoretical distribution! Generally speaking the ratio of variances will follow an $F_{n_1-1,n_2-1}$ distribution under the null hypothesis that the variances are equal:</span>
<span id="cb56-448"><a href="#cb56-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-449"><a href="#cb56-449" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, class.source = 'fold-hide'}</span></span>
<span id="cb56-450"><a href="#cb56-450" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb56-451"><a href="#cb56-451" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">612</span>)</span>
<span id="cb56-452"><a href="#cb56-452" aria-hidden="true" tabindex="-1"></a>placebo <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">10</span>, <span class="at">scale=</span><span class="dv">3</span>)</span>
<span id="cb56-453"><a href="#cb56-453" aria-hidden="true" tabindex="-1"></a>vaccine <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span><span class="dv">50</span>, <span class="at">shape=</span><span class="dv">5</span>, <span class="at">scale=</span><span class="fu">sqrt</span>(<span class="dv">18</span>))</span>
<span id="cb56-454"><a href="#cb56-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-455"><a href="#cb56-455" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span> <span class="sc">-</span> <span class="dv">1</span> <span class="co">#set number of times to complete permutation sampling</span></span>
<span id="cb56-456"><a href="#cb56-456" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb56-457"><a href="#cb56-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-458"><a href="#cb56-458" aria-hidden="true" tabindex="-1"></a>nP <span class="ot">&lt;-</span> <span class="fu">length</span>(placebo)</span>
<span id="cb56-459"><a href="#cb56-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-460"><a href="#cb56-460" aria-hidden="true" tabindex="-1"></a>obs_ratio <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo)<span class="sc">/</span><span class="fu">var</span>(vaccine) <span class="co"># calculate the ratio of the variances</span></span>
<span id="cb56-461"><a href="#cb56-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-462"><a href="#cb56-462" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">612</span>) <span class="co">#set seed for reproducibility</span></span>
<span id="cb56-463"><a href="#cb56-463" aria-hidden="true" tabindex="-1"></a>pool_dat <span class="ot">&lt;-</span> <span class="fu">c</span>(placebo, vaccine)</span>
<span id="cb56-464"><a href="#cb56-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-465"><a href="#cb56-465" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb56-466"><a href="#cb56-466" aria-hidden="true" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(pool_dat), <span class="at">size=</span>nP, <span class="at">replace=</span>F)</span>
<span id="cb56-467"><a href="#cb56-467" aria-hidden="true" tabindex="-1"></a>    placebo_permute <span class="ot">&lt;-</span> pool_dat[index]</span>
<span id="cb56-468"><a href="#cb56-468" aria-hidden="true" tabindex="-1"></a>    vaccine_permute <span class="ot">&lt;-</span> pool_dat[<span class="sc">-</span>index]</span>
<span id="cb56-469"><a href="#cb56-469" aria-hidden="true" tabindex="-1"></a>    result[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(placebo_permute) <span class="sc">/</span> <span class="fu">var</span>(vaccine_permute)</span>
<span id="cb56-470"><a href="#cb56-470" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-471"><a href="#cb56-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-472"><a href="#cb56-472" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb56-473"><a href="#cb56-473" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( result, <span class="at">xlab=</span><span class="st">'Var(Placebo) / Var(Vaccine)'</span>, </span>
<span id="cb56-474"><a href="#cb56-474" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">'Permutation Distribution for Ratio of Variances'</span>, <span class="at">freq=</span>F, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</span>
<span id="cb56-475"><a href="#cb56-475" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">df</span>(x,<span class="at">df1=</span><span class="dv">49</span>,<span class="at">df2=</span><span class="dv">49</span>),<span class="at">add=</span>T, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">'orangered2'</span>)</span>
<span id="cb56-476"><a href="#cb56-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb56-477"><a href="#cb56-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-478"><a href="#cb56-478" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>